(this.webpackJsonpauratool=this.webpackJsonpauratool||[]).push([[0],{185:function(e,t,n){e.exports=n.p+"static/media/logo.d8948e3c.svg"},195:function(e,t,n){e.exports=n(393)},207:function(e,t,n){},385:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=385},393:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),r=n(35),i=n.n(r),s=n(14),l=n.n(s),c=(n(206),n(207),n(42)),d=n(52),u=n(54),m=n(59),f=n(36),h=n(125),p=n.n(h),v=n(172),b=n(173),y=n(5),x=n.n(y),g=n(55),E=n(37),w=function(e,t){return{min:{x:Math.min(e.x,t.x),y:Math.min(e.y,t.y)},max:{x:Math.max(e.x,t.x),y:Math.max(e.y,t.y)}}},k=function(e,t){return!(t.min.x>=e.max.x||t.max.x<=e.min.x||t.max.y<=e.min.y||t.min.y>=e.max.y)},C=function(e,t){var n=e.x-t.x,o=e.y-t.y;return n*n+o*o},S=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n?e.x>=t.min.x&&e.x<=t.max.x&&e.y>=t.min.y&&e.y<=t.max.y:e.x>t.min.x&&e.x<t.max.x&&e.y>t.min.y&&e.y<t.max.y},O=function(e,t,n){return e.x-t<n.min.x||e.x+t>n.max.x||e.y-t<n.min.y||e.y+t>n.max.y},T=function(e,t,n,o){try{return e.evalFunc(Object(E.a)(Object(g.a)({},e.utilVar,t.vars[e.utilVar]),n,{},o))}catch(a){return 0}},R=n(44),M=n(174),B=n.n(M),P={C_m:{desc:"Cost of sending and receiving an object migration",defaultValue:1},C_c:{desc:"Cost of sending and receiving an aura creation",defaultValue:1},C_u:{desc:"Cost of sending and receiving an aura update",defaultValue:1},C_d:{desc:"Cost of sending and receiving an aura deletion",defaultValue:1},C_i:{desc:"Cost of number of objects out of host region (islands)",defaultValue:1}},_={sigma:{type:"count",desc:"Number of servers"},N:{type:"count",desc:"Total number of objects in the world"},t:{type:"count",desc:"Time since boundaries were last moved (seconds)"}},I={lambda:{type:"proportion",desc:"CPU load of the server"},delta:{type:"count",desc:"Frame time for the physics simulation step (milliseconds)"},alpha:{type:"proportion",desc:"Number of active (awake) objects"},beta:{type:"proportion",desc:"Number of objects near a boundary"},n:{type:"count",desc:"Number of objects managed by this server"}},F=function(e){return o.createElement("div",null,o.createElement("h5",null,"Constants (click to edit)"),o.createElement(R.a,{hover:!0,striped:!0,size:"sm"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,"Name"),o.createElement("th",null,"Value"),o.createElement("th",null,"Description"))),o.createElement("tbody",null,Object.keys(e.utilConstants).map((function(t,n){return o.createElement("tr",{key:n},o.createElement("td",null,o.createElement(l.a.Node,null,t)),o.createElement(B.a,{html:"".concat(e.utilConstants[t]),tagName:"td",onChange:function(n){return e.onUtilConstantUpdated(t,parseFloat(n.target.value.trim()))}}),o.createElement("td",null,P[t].desc))})))),o.createElement("h5",null,"Global variables"),o.createElement(R.a,{hover:!0,striped:!0,size:"sm"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,"Name"),o.createElement("th",null,"Value"),o.createElement("th",null,"Type"),o.createElement("th",null,"Description"))),o.createElement("tbody",null,Object.keys(e.utilGlobalVars).map((function(t,n){return o.createElement("tr",{key:n},o.createElement("td",null,o.createElement(l.a.Node,null,t)),o.createElement("td",null,e.utilGlobalVars[t].toFixed(2)),o.createElement("td",null,_[t].type),o.createElement("td",null,_[t].desc))})))),o.createElement("h5",null,"Server-local variables"),o.createElement(R.a,{hover:!0,striped:!0,size:"sm"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,"Name"),o.createElement("th",null,"Type"),o.createElement("th",null,"Description"))),o.createElement("tbody",null,Object.keys(I).map((function(e,t){return o.createElement("tr",{key:t},o.createElement("td",null,o.createElement(l.a.Node,null,e)),o.createElement("td",null,I[e].type),o.createElement("td",null,I[e].desc))})))),o.createElement("h5",null,"Server-local variable values"),e.boundaries.length>0&&o.createElement(R.a,{hover:!0,striped:!0,size:"sm"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,"Server"),Object.keys(e.boundaries[0].vars).map((function(e,t){return o.createElement("th",{key:t,title:"".concat(I[e].desc," (").concat(I[e].type,")")},o.createElement(l.a.Node,null,e))})))),o.createElement("tbody",null,e.boundaries.map((function(e,t){return o.createElement("tr",{key:t},o.createElement("td",null,t),Object.keys(e.vars).map((function(t,n){return o.createElement("td",{key:n},e.vars[t].toFixed(2))})))})))))},D=n(38),U=n(176),A=n(12),N=n(39),j=n(13),V=n(47),z=n(130),G=n(46),W=n(103),L=n(191);function H(){var e=Object(D.a)(["\n\tpadding: 0.25rem;\n\tposition: absolute;\n"]);return H=function(){return e},e}function q(){var e=Object(D.a)(["\n\tdisplay: flex;\n\tflex-direction: row;\n"]);return q=function(){return e},e}function Y(){var e=Object(D.a)(["\n\tdisplay: flex;\n\tflex-direction: column;\n"]);return Y=function(){return e},e}function J(){var e=Object(D.a)(["\n\tflex: 1;\n\theight: 100%;\n\twidth: 100%;\n\tmin-width: 0;\n\tmin-height: 0;\n"]);return J=function(){return e},e}var K=N.a.div(J()),Z=Object(N.a)(K)(Y()),X=Object(N.a)(K)(q()),$=N.a.div(H());function Q(){var e=Object(D.a)(["\n\toverflow-y: scroll;\n"]);return Q=function(){return e},e}var ee=Object(N.a)(K)(Q()),te=function(e){var t={position:"absolute",top:"2.5rem",right:0,zIndex:200},n={position:"fixed",top:"0px",right:"0px",bottom:"0px",left:"0px"},a=e.boundaries.map((function(t){return function(e,t,n,o,a){if(!e.evalFunc)return 0;var r=Object(E.a)({},n.vars,{},o,{},a);t.forEach((function(e){e.evalFunc&&"x"!==e.utilVar&&(r["U_".concat(e.utilVar)]=T(e,n,o,a))}));try{return e.evalFunc(r)}catch(i){return 0}}(e.utilServer,e.utilFunctions,t,e.utilConstants,e.utilGlobalVars)})),r=a.length?a.reduce((function(e,t){return e+t})).toFixed(2):0;return o.createElement(ee,null,o.createElement(L.a,{id:"control-panel"},o.createElement(W.a,{eventKey:"variables",title:"Variables"},o.createElement(F,{boundaries:e.boundaries,utilConstants:e.utilConstants,utilGlobalVars:e.utilGlobalVars,onUtilConstantUpdated:e.onUtilConstantUpdated})),o.createElement(W.a,{eventKey:"functions",title:"Functions"},o.createElement("h5",null,"Utility functions"),e.utilFunctions.map((function(a,r){return o.createElement(G.a,{className:"mb-1",key:r},o.createElement(G.a.Prepend,null,o.createElement(G.a.Text,null,o.createElement(l.a.Node,{inline:!0},"U_".concat(a.utilVar,"=").concat(a.expression)))),o.createElement(z.a,{placeholder:"Function (in ASCIImath)","aria-label":"Function (in ASCIImath)",onChange:function(t){return t.currentTarget.value&&e.onUtilFunctionUpdated(r,t.currentTarget.value)},value:a.expression}),o.createElement(G.a.Append,null,o.createElement(V.a,null,o.createElement(V.a.Toggle,{id:"util-var-dropdown-".concat(r),variant:"dark",style:{borderRadius:0}},o.createElement(l.a.Node,{inline:!0},a.utilVar)),o.createElement(V.a.Menu,null,o.createElement(V.a.Header,null,"Utility variable"),o.createElement(V.a.Item,{onSelect:function(){e.onUtilVarUpdated(r,"x")}},o.createElement(l.a.Node,{inline:!0},"x")),o.createElement(V.a.Divider,null),Object.keys(I).map((function(t,n){return o.createElement(V.a.Item,{key:n,onSelect:function(){e.onUtilVarUpdated(r,t)}},o.createElement(l.a.Node,null,t))})))),o.createElement(j.a,{onClick:function(){return e.onChangeColorClicked(r)},style:{backgroundColor:a.color}},o.createElement(A.a,{icon:"palette"})),e.showColorPicker&&e.colorIndex===r&&o.createElement("div",{style:t},o.createElement("div",{style:n,onClick:function(){return e.onChangeColorClicked(void 0)}}),o.createElement(U.SketchPicker,{disableAlpha:!0,color:a.color,onChange:e.onColorUpdated})),o.createElement(j.a,{variant:"danger",onClick:function(){return e.onUtilFunctionDeleted(r)}},o.createElement(A.a,{icon:"trash"}))))})),o.createElement(j.a,{className:"mb-2",variant:"success",onClick:e.onUtilFunctionAdded},o.createElement(A.a,{icon:"plus"}),"\xa0Add function"),o.createElement("h5",null,"Local utility"),o.createElement(G.a,{className:"mb-1"},o.createElement(G.a.Prepend,null,o.createElement(G.a.Text,null,o.createElement(l.a.Node,{inline:!0},"U_i=".concat(e.utilServer.expression)))),o.createElement(z.a,{placeholder:"Function (in ASCIImath)","aria-label":"Function (in ASCIImath)",onChange:function(t){return t.currentTarget.value&&e.onServerUtilFunctionUpdated(t.currentTarget.value)},value:e.utilServer.expression})),o.createElement(R.a,{hover:!0,striped:!0,size:"sm"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("th",null,"Server"),o.createElement("th",null,o.createElement(l.a.Node,null,"U_i")))),o.createElement("tbody",null,e.boundaries.map((function(e,t){return o.createElement("tr",{key:t},o.createElement("td",null,t),o.createElement("td",null,o.createElement(l.a.Node,null,a[t].toFixed(2))))})))),o.createElement("h5",null,"Global utility"),o.createElement(l.a.Node,null,"U_g = U_0 + U_1 + ... + U_n"),"= ",r),o.createElement(W.a,{eventKey:"boundaries",title:"Boundaries"},o.createElement(R.a,{hover:!0,striped:!0,size:"sm"},o.createElement("thead",null,o.createElement("tr",null,o.createElement("td",null,"Server"),o.createElement("td",null,o.createElement(l.a.Node,null,"x_1")),o.createElement("td",null,o.createElement(l.a.Node,null,"y_1")),o.createElement("td",null,o.createElement(l.a.Node,null,"x_2")),o.createElement("td",null,o.createElement(l.a.Node,null,"y_2")),o.createElement("td",null,"Width"),o.createElement("td",null,"Height"))),o.createElement("tbody",null,e.boundaries.map((function(e,t){return o.createElement("tr",{key:t},o.createElement("td",null,t),o.createElement("td",null,e.bounds.min.x.toFixed(2)),o.createElement("td",null,e.bounds.min.y.toFixed(2)),o.createElement("td",null,e.bounds.max.x.toFixed(2)),o.createElement("td",null,e.bounds.max.y.toFixed(2)),o.createElement("td",null,(e.bounds.max.x-e.bounds.min.x).toFixed(2)),o.createElement("td",null,(e.bounds.max.y-e.bounds.min.y).toFixed(2)))})))))))},ne=n(58),oe=n(183),ae=n(127),re=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(d.a)(this,Object(u.a)(t).call(this,e))).updateCurves=Object(ae.a)((function(e,t,o){var a=(n.state.xRange[1]-n.state.xRange[0])/100,r=new Array;return e.forEach((function(e){if(e.evalFunc){var i={label:"U(".concat(e.utilVar,")"),fill:!1,showLine:!0,pointRadius:0,pointHitRadius:2,backgroundColor:e.color,borderColor:e.color,borderWidth:2};i.data=new Array(100);try{for(var s=n.state.xRange[0];s<=n.state.xRange[1];s+=a){var l=e.evalFunc(Object(E.a)(Object(g.a)({},e.utilVar,s),t,{},o));i.data.push({x:s,y:l})}r.push(i)}catch(c){}}})),r})),n.updatePoints=Object(ae.a)((function(e,t,n,o){var a=new Array;return t.forEach((function(t){if(t.evalFunc&&"x"!==t.utilVar)try{e.forEach((function(e,r){var i=e.vars[t.utilVar],s=T(t,e,n,o);a.push({label:"B".concat(r," U(").concat(t.utilVar,")"),fill:!0,showLine:!1,pointRadius:6,pointStyle:"circle",pointHitRadius:2,backgroundColor:e.color,borderColor:t.color,data:[{x:i,y:s}]})}))}catch(r){}})),a})),n.state={xRange:[0,1],yRange:[0,1]},n}return Object(m.a)(t,e),Object(ne.a)(t,[{key:"render",value:function(){var e=this.updateCurves(this.props.utilFunctions,this.props.utilConstants,this.props.utilGlobalVars),t={datasets:this.updatePoints(this.props.boundaries,this.props.utilFunctions,this.props.utilConstants,this.props.utilGlobalVars).concat(e)};return o.createElement(oe.a,{data:t,options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0}}})}}]),t}(o.Component),ie=n(399),se=n(190),le=n(185),ce=n.n(le),de=n(9),ue=function(e){return o.createElement(ie.a,{bg:"dark",variant:"dark",expand:"lg"},o.createElement(ie.a.Brand,{href:"#home"},o.createElement("img",{src:ce.a,width:"200",className:"d-inline-block align-top",alt:"auratool"})),o.createElement(ie.a.Toggle,{"aria-controls":"responsive-navbar-nav"}),o.createElement(ie.a.Collapse,{id:"responsive-navbar-nav"},o.createElement(se.a,{className:"ml-auto"},o.createElement(se.a.Link,{onClick:function(){return e.onImportClickedCallback&&e.onImportClickedCallback()}},o.createElement(A.a,{icon:de.h})," Import"),o.createElement(se.a.Link,{onClick:function(){return e.onExportClickedCallback&&e.onExportClickedCallback()}},o.createElement(A.a,{icon:de.g})," Export"))))},me=n(101),fe=n(397),he=n(64),pe=n(189),ve=n(398),be={height:"12rem",padding:"1rem",textAlign:"center",fontSize:"1rem",lineHeight:"normal",border:"1px dashed darkgrey",borderRadius:"1rem",display:"table",width:"100%"},ye={display:"table-cell",verticalAlign:"middle"},xe={marginLeft:"auto",marginRight:"auto"},ge=function(e){var t=null,n=Object(ve.a)({accept:[me.a.FILE],drop:function(t,n){var o=n.getItem().files;o&&e.onFilesSelected&&e.onFilesSelected(o)},collect:function(e){return{isOver:e.isOver(),canDrop:e.canDrop()}}}),o=Object(pe.a)(n,2),r=o[0],i=r.canDrop,s=r.isOver,l=o[1],c="white";return i&&s?(c="lightgreen",a.a.createElement("div",{ref:l,style:Object(E.a)({},be,{backgroundColor:c})},a.a.createElement("div",{style:ye},a.a.createElement("div",{style:xe},"Release to drop!")))):i?(c="lightyellow",a.a.createElement("div",{ref:l,style:Object(E.a)({},be,{backgroundColor:c})},a.a.createElement("div",{style:ye},a.a.createElement("div",{style:xe},"Drag file here...")))):a.a.createElement("div",{ref:l,style:Object(E.a)({},be,{backgroundColor:c})},a.a.createElement("div",{style:ye},a.a.createElement("div",{style:xe},a.a.createElement("p",null,"Drag and drop an exported .json file"),a.a.createElement("p",null,"or:"),a.a.createElement(j.a,{variant:"success",onClick:function(){t&&t.click()}},a.a.createElement(A.a,{icon:de.i})," Select from your computer"),a.a.createElement("input",{type:"file",id:"file",ref:function(e){t=e},style:{display:"none"},onChange:function(t){t.target.files&&e.onFilesSelected&&e.onFilesSelected(t.target.files)}}))))},Ee=function(e){return o.createElement(he.a,{show:e.show,onHide:function(){e.onHide&&e.onHide()}},o.createElement(he.a.Header,{closeButton:!0},o.createElement(he.a.Title,null,"Import data")),o.createElement(he.a.Body,null,o.createElement(fe.a,{backend:me.b},o.createElement(ge,{onFilesSelected:function(t){e.onFilesSelected&&e.onFilesSelected(t)}}))),o.createElement(he.a.Footer,null,o.createElement(j.a,{variant:"primary",onClick:function(){e.onClosed&&e.onClosed()}},o.createElement(A.a,{icon:de.h})," Import")))},we=n(41),ke=n.n(we),Ce=n(16),Se=n.n(Ce),Oe=n(76),Te=n.n(Oe),Re=n(50),Me=n.n(Re),Be=n(100),Pe=n.n(Be),_e=n(62),Ie=n.n(_e),Fe=n(22),De=n.n(Fe),Ue=function(){function e(){Object(c.a)(this,e)}return Object(ne.a)(e,null,[{key:"create",value:function(t){var n={controller:e,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,options:{width:800,height:600,pixelRatio:1,background:"#18181d",wireframeBackground:"#0f0f13",gridSize:50,hasBounds:!!t.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showBroadphase:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showShadows:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1,showGrid:!0,crosshairSnap:!1}},o=Se.a.extend(n,t);return o.canvas&&(o.canvas.width=o.options.width||o.canvas.width,o.canvas.height=o.options.height||o.canvas.height),o.mouse=t.mouse,o.engine=t.engine,o.canvas=o.canvas||e._createCanvas(o.options.width,o.options.height),o.context=o.canvas.getContext("2d"),o.textures={},o.bounds=o.bounds||{min:{x:0,y:0},max:{x:o.canvas.width,y:o.canvas.height}},1!==o.options.pixelRatio&&e.setPixelRatio(o,o.options.pixelRatio),Se.a.isElement(o.element)?o.element.appendChild(o.canvas):o.canvas.parentNode||Se.a.log("PhysicsRenderer.create: options.element was undefined, render.canvas was created but not appended","warn"),o}},{key:"run",value:function(t){!function n(o){t.frameRequestId=e._requestAnimationFrame.call(window,n),e.world(t)}()}},{key:"stop",value:function(t){e._cancelAnimationFrame.call(window,t.frameRequestId)}},{key:"setPixelRatio",value:function(t,n){var o=t.options,a=t.canvas;"auto"===n&&(n=e._getPixelRatio(a)),o.pixelRatio=n,a.setAttribute("data-pixel-ratio",n),a.width=o.width*n,a.height=o.height*n,a.style.width=o.width+"px",a.style.height=o.height+"px"}},{key:"lookAt",value:function(e,t,n,o){o="undefined"===typeof o||o,t=Se.a.isArray(t)?t:[t],n=n||{x:0,y:0};for(var a={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},r=0;r<t.length;r+=1){var i=t[r],s=i.bounds?i.bounds.min:i.min||i.position||i,l=i.bounds?i.bounds.max:i.max||i.position||i;s&&l&&(s.x<a.min.x&&(a.min.x=s.x),l.x>a.max.x&&(a.max.x=l.x),s.y<a.min.y&&(a.min.y=s.y),l.y>a.max.y&&(a.max.y=l.y))}var c=a.max.x-a.min.x+2*n.x,d=a.max.y-a.min.y+2*n.y,u=e.canvas.height,m=e.canvas.width/u,f=c/d,h=1,p=1;f>m?p=f/m:h=m/f,e.options.hasBounds=!0,e.bounds.min.x=a.min.x,e.bounds.max.x=a.min.x+c*h,e.bounds.min.y=a.min.y,e.bounds.max.y=a.min.y+d*p,o&&(e.bounds.min.x+=.5*c-c*h*.5,e.bounds.max.x+=.5*c-c*h*.5,e.bounds.min.y+=.5*d-d*p*.5,e.bounds.max.y+=.5*d-d*p*.5),e.bounds.min.x-=n.x,e.bounds.max.x-=n.x,e.bounds.min.y-=n.y,e.bounds.max.y-=n.y,e.mouse&&(Ie.a.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),Ie.a.setOffset(e.mouse,e.bounds.min))}},{key:"startViewTransform",value:function(e){var t=e.bounds.max.x-e.bounds.min.x,n=e.bounds.max.y-e.bounds.min.y,o=t/e.options.width,a=n/e.options.height;e.context.setTransform(e.options.pixelRatio/o,0,0,e.options.pixelRatio/a,0,0),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)}},{key:"endViewTransform",value:function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)}},{key:"drawGrid",value:function(t,n){var o=t.options.gridSize,a=t.canvas.width,r=t.canvas.height,i=t.bounds,s=i.max.x-i.min.x,l=i.max.y-i.min.y,c=a/s,d=-i.min.x,u=-i.min.y,m=e._mod(d,o),f=e._mod(u,o);n.lineWidth=1,n.setLineDash([]),n.strokeStyle="rgb(128, 128, 255, 0.2)",n.fillStyle="black";var h=function(t,o){t=e._roundDrawCoord(t),n.beginPath(),n.moveTo(t,0),n.lineTo(t,r),n.stroke(),n.fillText(o,t+2,r-2)},p=function(t,o){t=e._roundDrawCoord(t),n.beginPath(),n.moveTo(0,t),n.lineTo(a,t),n.stroke(),n.fillText(o,0,t-4)},v=Math.floor(i.min.x/o)*o,b=Math.floor(i.min.y/o)*o;0!==m&&(v+=o),0!==f&&(b+=o);for(var y=m;y<s;y+=o,v+=o)e._almostEqual(y,d)?(n.save(),n.strokeStyle="rgb(255, 128, 128, 0.5)",h(y*c,v),n.restore()):h(y*c,v);for(var x=f;x<l;x+=o,b+=o)e._almostEqual(x,u)?(n.save(),n.strokeStyle="rgb(255, 128, 128, 0.5)",p(x*c,b),n.restore()):p(x*c,b)}},{key:"drawCrosshair",value:function(t,n){var o=t.canvas.width/(t.bounds.max.x-t.bounds.min.x),a=t.options.gridSize;if(t.mouse){var r=t.mouse.position.x,i=t.mouse.position.y;t.options.crosshairSnap&&(r=Math.round(r/a)*a,i=Math.round(i/a)*a);var s=e._roundDrawCoord((r-t.bounds.min.x)*o),l=e._roundDrawCoord((i-t.bounds.min.y)*o);n.setLineDash([5,8]),n.lineWidth=1,n.strokeStyle="black",n.fillStyle="black",n.beginPath(),n.moveTo(s,0),n.lineTo(s,t.canvas.height),n.stroke(),n.beginPath(),n.moveTo(0,l),n.lineTo(t.canvas.width,l),n.stroke(),n.fillText("".concat(Object(f.round)(r,2),", ").concat(Object(f.round)(i,2)),s+10,l-10)}}},{key:"world",value:function(t){var n,o=t.engine,a=o.world,r=t.canvas,i=t.context,s=t.options,l=Te.a.allBodies(a),c=Te.a.allConstraints(a),d=s.wireframes?s.wireframeBackground:s.background,u=[],m=[],f={timestamp:o.timing.timestamp};if(Me.a.trigger(t,"beforeRender",f),t.currentBackground!==d&&e._applyBackground(t,d),i.globalCompositeOperation="source-in",i.fillStyle="transparent",i.fillRect(0,0,r.width,r.height),i.globalCompositeOperation="source-over",t.options.showGrid&&e.drawGrid(t,i),Me.a.trigger(t,"beforeObjects",f),s.hasBounds){for(n=0;n<l.length;n++){var h=l[n];ke.a.overlaps(h.bounds,t.bounds)&&u.push(h)}for(n=0;n<c.length;n++){var p=c[n],v=p.bodyA,b=p.bodyB,y=p.pointA,x=p.pointB;v&&(y=De.a.add(v.position,p.pointA)),b&&(x=De.a.add(b.position,p.pointB)),y&&x&&((ke.a.contains(t.bounds,y)||ke.a.contains(t.bounds,x))&&m.push(p))}e.startViewTransform(t),t.mouse&&(Ie.a.setScale(t.mouse,{x:(t.bounds.max.x-t.bounds.min.x)/t.options.width,y:(t.bounds.max.y-t.bounds.min.y)/t.options.height}),Ie.a.setOffset(t.mouse,t.bounds.min))}else m=c,u=l,1!==t.options.pixelRatio&&t.context.setTransform(t.options.pixelRatio,0,0,t.options.pixelRatio,0,0);!s.wireframes||o.enableSleeping&&s.showSleeping?e.bodies(t,u,i):(s.showConvexHulls&&e.bodyConvexHulls(t,u,i),e.bodyWireframes(t,u,i)),s.showBounds&&e.bodyBounds(t,u,i),(s.showAxes||s.showAngleIndicator)&&e.bodyAxes(t,u,i),s.showPositions&&e.bodyPositions(t,u,i),s.showVelocity&&e.bodyVelocity(t,u,i),s.showIds&&e.bodyIds(t,u,i),s.showSeparations&&e.separations(t,o.pairs.list,i),s.showCollisions&&e.collisions(t,o.pairs.list,i),s.showVertexNumbers&&e.vertexNumbers(t,u,i),s.showMousePosition&&e.mousePosition(t,t.mouse,i),e.constraints(m,i),s.showBroadphase&&o.broadphase.controller===Pe.a&&e.grid(t,o.broadphase,i),s.showDebug&&e.debug(t,i),s.hasBounds&&e.endViewTransform(t),Me.a.trigger(t,"afterRender",f),t.options.showCrosshair&&e.drawCrosshair(t,i)}},{key:"debug",value:function(e,t){var n=t,o=e.engine,a=o.world,r=o.metrics,i=e.options,s=Te.a.allBodies(a);if(o.timing.timestamp-(e.debugTimestamp||0)>=500){var l="";r.timing&&(l+="fps: "+Math.round(r.timing.fps)+"    "),r.extended&&(r.timing&&(l+="delta: "+r.timing.delta.toFixed(3)+"    ",l+="correction: "+r.timing.correction.toFixed(3)+"    "),l+="bodies: "+s.length+"    ",o.broadphase.controller===Pe.a&&(l+="buckets: "+r.buckets+"    "),l+="\n",l+="collisions: "+r.collisions+"    ",l+="pairs: "+o.pairs.list.length+"    ",l+="broad: "+r.broadEff+"    ",l+="mid: "+r.midEff+"    ",l+="narrow: "+r.narrowEff+"    "),e.debugString=l,e.debugTimestamp=o.timing.timestamp}if(e.debugString){n.font="12px Arial",i.wireframes?n.fillStyle="rgba(255,255,255,0.5)":n.fillStyle="rgba(0,0,0,0.5)";for(var c=e.debugString.split("\n"),d=0;d<c.length;d++)n.fillText(c[d],50,50+18*d)}}},{key:"constraints",value:function(e,t){for(var n=t,o=0;o<e.length;o++){var a=e[o];if(a.render.visible&&a.pointA&&a.pointB){var r,i,s=a.bodyA,l=a.bodyB;if(r=s?De.a.add(s.position,a.pointA):a.pointA,"pin"===a.render.type)n.beginPath(),n.arc(r.x,r.y,3,0,2*Math.PI),n.closePath();else{if(i=l?De.a.add(l.position,a.pointB):a.pointB,n.beginPath(),n.moveTo(r.x,r.y),"spring"===a.render.type)for(var c,d=De.a.sub(i,r),u=De.a.perp(De.a.normalise(d)),m=Math.ceil(Se.a.clamp(a.length/5,12,20)),f=1;f<m;f+=1)c=f%2===0?1:-1,n.lineTo(r.x+d.x*(f/m)+u.x*c*4,r.y+d.y*(f/m)+u.y*c*4);n.lineTo(i.x,i.y)}a.render.lineWidth&&(n.lineWidth=a.render.lineWidth,n.strokeStyle=a.render.strokeStyle,n.stroke()),a.render.anchors&&(n.fillStyle=a.render.strokeStyle,n.beginPath(),n.arc(r.x,r.y,3,0,2*Math.PI),n.arc(i.x,i.y,3,0,2*Math.PI),n.closePath(),n.fill())}}}},{key:"bodyShadows",value:function(e,t,n){for(var o=n,a=0;a<t.length;a++){var r=t[a];if(r.render.visible){if(r.circleRadius)o.beginPath(),o.arc(r.position.x,r.position.y,r.circleRadius,0,2*Math.PI),o.closePath();else{o.beginPath(),o.moveTo(r.vertices[0].x,r.vertices[0].y);for(var i=1;i<r.vertices.length;i++)o.lineTo(r.vertices[i].x,r.vertices[i].y);o.closePath()}var s=r.position.x-.5*e.options.width,l=r.position.y-.2*e.options.height,c=Math.abs(s)+Math.abs(l);o.shadowColor="rgba(0,0,0,0.15)",o.shadowOffsetX=.05*s,o.shadowOffsetY=.05*l,o.shadowBlur=1+12*Math.min(1,c/1e3),o.fill(),o.shadowColor=null,o.shadowOffsetX=null,o.shadowOffsetY=null,o.shadowBlur=null}}}},{key:"bodies",value:function(t,n,o){var a,r,i,s,l=o,c=t.options,d=c.showInternalEdges||!c.wireframes;for(i=0;i<n.length;i++)if((a=n[i]).render.visible)for(s=a.parts.length>1?1:0;s<a.parts.length;s++)if((r=a.parts[s]).render.visible){if(r.render.sprite&&r.render.sprite.texture&&!c.wireframes){var u=r.render.sprite,m=e._getTexture(t,u.texture);l.translate(r.position.x,r.position.y),l.rotate(r.angle),l.drawImage(m,m.width*-u.xOffset*u.xScale,m.height*-u.yOffset*u.yScale,m.width*u.xScale,m.height*u.yScale),l.rotate(-r.angle),l.translate(-r.position.x,-r.position.y)}else{if(r.circleRadius)l.beginPath(),l.arc(r.position.x,r.position.y,r.circleRadius,0,2*Math.PI);else{l.beginPath(),l.moveTo(r.vertices[0].x,r.vertices[0].y);for(var f=1;f<r.vertices.length;f++)!r.vertices[f-1].isInternal||d?l.lineTo(r.vertices[f].x,r.vertices[f].y):l.moveTo(r.vertices[f].x,r.vertices[f].y),r.vertices[f].isInternal&&!d&&l.moveTo(r.vertices[(f+1)%r.vertices.length].x,r.vertices[(f+1)%r.vertices.length].y);l.lineTo(r.vertices[0].x,r.vertices[0].y),l.closePath()}c.wireframes?(l.lineWidth=1,l.strokeStyle="#bbb",l.stroke()):(c.showSleeping&&a.isSleeping?l.fillStyle=e._colorLuminance(r.render.fillStyle,-.2):l.fillStyle=r.render.fillStyle,r.render.lineWidth&&(l.lineWidth=r.render.lineWidth,l.strokeStyle=r.render.strokeStyle,l.stroke()),l.fill())}l.globalAlpha=1}}},{key:"bodyWireframes",value:function(e,t,n){var o,a,r,i,s,l=n,c=e.options.showInternalEdges;for(l.beginPath(),r=0;r<t.length;r++)if((o=t[r]).render.visible)for(s=o.parts.length>1?1:0;s<o.parts.length;s++){for(a=o.parts[s],l.moveTo(a.vertices[0].x,a.vertices[0].y),i=1;i<a.vertices.length;i++)!a.vertices[i-1].isInternal||c?l.lineTo(a.vertices[i].x,a.vertices[i].y):l.moveTo(a.vertices[i].x,a.vertices[i].y),a.vertices[i].isInternal&&!c&&l.moveTo(a.vertices[(i+1)%a.vertices.length].x,a.vertices[(i+1)%a.vertices.length].y);l.lineTo(a.vertices[0].x,a.vertices[0].y)}l.lineWidth=1,l.strokeStyle="#bbb",l.stroke()}},{key:"bodyConvexHulls",value:function(e,t,n){var o,a,r,i=n;for(i.beginPath(),a=0;a<t.length;a++)if((o=t[a]).render.visible&&1!==o.parts.length){for(i.moveTo(o.vertices[0].x,o.vertices[0].y),r=1;r<o.vertices.length;r++)i.lineTo(o.vertices[r].x,o.vertices[r].y);i.lineTo(o.vertices[0].x,o.vertices[0].y)}i.lineWidth=1,i.strokeStyle="rgba(255,255,255,0.2)",i.stroke()}},{key:"vertexNumbers",value:function(e,t,n){var o,a,r,i=n;for(o=0;o<t.length;o++){var s=t[o].parts;for(r=s.length>1?1:0;r<s.length;r++){var l=s[r];for(a=0;a<l.vertices.length;a++)i.fillStyle="rgba(255,255,255,0.2)",i.fillText(o+"_"+a,l.position.x+.8*(l.vertices[a].x-l.position.x),l.position.y+.8*(l.vertices[a].y-l.position.y))}}}},{key:"mousePosition",value:function(e,t,n){var o=n;o.fillStyle="rgba(255,255,255,0.8)",o.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)}},{key:"bodyBounds",value:function(e,t,n){var o=n,a=e.options;o.beginPath();for(var r=0;r<t.length;r++){if(t[r].render.visible)for(var i=t[r].parts,s=i.length>1?1:0;s<i.length;s++){var l=i[s];o.rect(l.bounds.min.x,l.bounds.min.y,l.bounds.max.x-l.bounds.min.x,l.bounds.max.y-l.bounds.min.y)}}a.wireframes?o.strokeStyle="rgba(255,255,255,0.08)":o.strokeStyle="rgba(0,0,0,0.1)",o.lineWidth=1,o.stroke()}},{key:"bodyAxes",value:function(e,t,n){var o,a,r,i,s=n,l=e.options;for(s.beginPath(),a=0;a<t.length;a++){var c=t[a],d=c.parts;if(c.render.visible)if(l.showAxes)for(r=d.length>1?1:0;r<d.length;r++)for(o=d[r],i=0;i<o.axes.length;i++){var u=o.axes[i];s.moveTo(o.position.x,o.position.y),s.lineTo(o.position.x+20*u.x,o.position.y+20*u.y)}else for(r=d.length>1?1:0;r<d.length;r++)for(o=d[r],i=0;i<o.axes.length;i++)s.moveTo(o.position.x,o.position.y),s.lineTo((o.vertices[0].x+o.vertices[o.vertices.length-1].x)/2,(o.vertices[0].y+o.vertices[o.vertices.length-1].y)/2)}l.wireframes?(s.strokeStyle="indianred",s.lineWidth=1):(s.strokeStyle="rgba(255, 255, 255, 0.4)",s.globalCompositeOperation="overlay",s.lineWidth=2),s.stroke(),s.globalCompositeOperation="source-over"}},{key:"bodyPositions",value:function(e,t,n){var o,a,r,i,s=n,l=e.options;for(s.beginPath(),r=0;r<t.length;r++)if((o=t[r]).render.visible)for(i=0;i<o.parts.length;i++)a=o.parts[i],s.arc(a.position.x,a.position.y,3,0,2*Math.PI,!1),s.closePath();for(l.wireframes?s.fillStyle="indianred":s.fillStyle="rgba(0,0,0,0.5)",s.fill(),s.beginPath(),r=0;r<t.length;r++)(o=t[r]).render.visible&&(s.arc(o.positionPrev.x,o.positionPrev.y,2,0,2*Math.PI,!1),s.closePath());s.fillStyle="rgba(255,165,0,0.8)",s.fill()}},{key:"bodyVelocity",value:function(e,t,n){var o=n;o.beginPath();for(var a=0;a<t.length;a++){var r=t[a];r.render.visible&&(o.moveTo(r.position.x,r.position.y),o.lineTo(r.position.x+2*(r.position.x-r.positionPrev.x),r.position.y+2*(r.position.y-r.positionPrev.y)))}o.lineWidth=3,o.strokeStyle="cornflowerblue",o.stroke()}},{key:"bodyIds",value:function(e,t,n){var o,a,r=n;for(o=0;o<t.length;o++)if(t[o].render.visible){var i=t[o].parts;for(a=i.length>1?1:0;a<i.length;a++){var s=i[a];r.font="12px Arial",r.fillStyle="rgba(255,255,255,0.5)",r.fillText(s.id,s.position.x+10,s.position.y-10)}}}},{key:"collisions",value:function(e,t,n){var o,a,r,i,s=n,l=e.options;for(s.beginPath(),r=0;r<t.length;r++)if((o=t[r]).isActive)for(a=o.collision,i=0;i<o.activeContacts.length;i++){var c=o.activeContacts[i].vertex;s.rect(c.x-1.5,c.y-1.5,3.5,3.5)}for(l.wireframes?s.fillStyle="rgba(255,255,255,0.7)":s.fillStyle="orange",s.fill(),s.beginPath(),r=0;r<t.length;r++)if((o=t[r]).isActive&&(a=o.collision,o.activeContacts.length>0)){var d=o.activeContacts[0].vertex.x,u=o.activeContacts[0].vertex.y;2===o.activeContacts.length&&(d=(o.activeContacts[0].vertex.x+o.activeContacts[1].vertex.x)/2,u=(o.activeContacts[0].vertex.y+o.activeContacts[1].vertex.y)/2),a.bodyB===a.supports[0].body||!0===a.bodyA.isStatic?s.moveTo(d-8*a.normal.x,u-8*a.normal.y):s.moveTo(d+8*a.normal.x,u+8*a.normal.y),s.lineTo(d,u)}l.wireframes?s.strokeStyle="rgba(255,165,0,0.7)":s.strokeStyle="orange",s.lineWidth=1,s.stroke()}},{key:"separations",value:function(e,t,n){var o,a,r,i,s,l=n,c=e.options;for(l.beginPath(),s=0;s<t.length;s++)if((o=t[s]).isActive){r=(a=o.collision).bodyA;var d=1;(i=a.bodyB).isStatic||r.isStatic||(d=.5),i.isStatic&&(d=0),l.moveTo(i.position.x,i.position.y),l.lineTo(i.position.x-a.penetration.x*d,i.position.y-a.penetration.y*d),d=1,i.isStatic||r.isStatic||(d=.5),r.isStatic&&(d=0),l.moveTo(r.position.x,r.position.y),l.lineTo(r.position.x+a.penetration.x*d,r.position.y+a.penetration.y*d)}c.wireframes?l.strokeStyle="rgba(255,165,0,0.5)":l.strokeStyle="orange",l.stroke()}},{key:"grid",value:function(e,t,n){var o=n;e.options.wireframes?o.strokeStyle="rgba(255,180,0,0.1)":o.strokeStyle="rgba(255,180,0,0.5)",o.beginPath();for(var a=Se.a.keys(t.buckets),r=0;r<a.length;r++){var i=a[r];if(!(t.buckets[i].length<2)){var s=i.split(/C|R/);o.rect(.5+parseInt(s[1],10)*t.bucketWidth,.5+parseInt(s[2],10)*t.bucketHeight,t.bucketWidth,t.bucketHeight)}}o.lineWidth=1,o.stroke()}},{key:"inspector",value:function(e,t){var n,o=e.selected,a=e.render,r=a.options;if(r.hasBounds){var i=a.bounds.max.x-a.bounds.min.x,s=a.bounds.max.y-a.bounds.min.y,l=i/a.options.width,c=s/a.options.height;t.scale(1/l,1/c),t.translate(-a.bounds.min.x,-a.bounds.min.y)}for(var d=0;d<o.length;d++){var u=o[d].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),u.type){case"body":n=u.bounds,t.beginPath(),t.rect(Math.floor(n.min.x-3),Math.floor(n.min.y-3),Math.floor(n.max.x-n.min.x+6),Math.floor(n.max.y-n.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var m=u.pointA;u.bodyA&&(m=u.pointB),t.beginPath(),t.arc(m.x,m.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",n=e.selectBounds,t.beginPath(),t.rect(Math.floor(n.min.x),Math.floor(n.min.y),Math.floor(n.max.x-n.min.x),Math.floor(n.max.y-n.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),r.hasBounds&&t.setTransform(1,0,0,1,0,0)}},{key:"_createCanvas",value:function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},n}},{key:"_getPixelRatio",value:function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}},{key:"_getTexture",value:function(e,t){var n=e.textures[t];return n||((n=e.textures[t]=new Image).src=t,n)}},{key:"_applyBackground",value:function(e,t){var n=t;/(jpg|gif|png)$/.test(t)&&(n="url("+t+")"),e.canvas.style.background=n,e.canvas.style.backgroundSize="contain",e.currentBackground=t}},{key:"_mod",value:function(e,t){return(e%t+t)%t}},{key:"_almostEqual",value:function(e,t){return Math.abs(e-t)<1e-5}},{key:"_roundDrawCoord",value:function(e){return Math.round(e)+.5}},{key:"_colorLuminance",value:function(e,t){(e=String(e).replace(/[^0-9a-f]/gi,"")).length<6&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),t=t||0;var n,o,a="#";for(o=0;o<3;o++)n=parseInt(e.substr(2*o,2),16),a+=("00"+(n=Math.round(Math.min(Math.max(0,n+n*t),255)).toString(16))).substr(n.length);return a}}]),e}();function Ae(){var e=Object(D.a)(["\n\tcursor: ",";\n"]);return Ae=function(){return e},e}Ue._requestAnimationFrame=function(){if("undefined"!==typeof window)return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout((function(){e(Se.a.now())}),1e3/60)}}(),Ue._cancelAnimationFrame=function(){if("undefined"!==typeof window)return window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame}();var Ne,je,Ve=N.a.canvas(Ae(),(function(e){return e.cursor}));!function(e){e[e.OBJECT=0]="OBJECT",e[e.BOUNDARY_EDIT=1]="BOUNDARY_EDIT",e[e.SNOOKER=2]="SNOOKER"}(Ne||(Ne={})),function(e){e[e.NONE=0]="NONE",e[e.LEFT_EDGE=1]="LEFT_EDGE",e[e.RIGHT_EDGE=2]="RIGHT_EDGE",e[e.TOP_EDGE=3]="TOP_EDGE",e[e.BOTTOM_EDGE=4]="BOTTOM_EDGE",e[e.TOP_LEFT_CORNER=5]="TOP_LEFT_CORNER",e[e.TOP_RIGHT_CORNER=6]="TOP_RIGHT_CORNER",e[e.BOTTOM_RIGHT_CORNER=7]="BOTTOM_RIGHT_CORNER",e[e.BOTTOM_LEFT_CORNER=8]="BOTTOM_LEFT_CORNER",e[e.HORIZONTAL_SPLIT=9]="HORIZONTAL_SPLIT",e[e.VERTICAL_SPLIT=10]="VERTICAL_SPLIT",e[e.CROSS_SPLIT=11]="CROSS_SPLIT"}(je||(je={}));var ze=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(d.a)(this,Object(u.a)(t).call(this,e))).matterEngine=void 0,n.matterMouse=void 0,n.matterMouseConstraint=void 0,n.matterRender=void 0,n.matterRunner=void 0,n.matterWorld=void 0,n.componentDidMount=function(){var e=n.state.canvasRef.current;if(e){var t=e.getContext("2d");if(t){t.font="12px Arial",e.style.width="100%",e.style.height="100%",n.updateCanvasDimensions(),e.oncontextmenu=function(){return!1},e.onselectstart=function(){return!1},n.matterWorld=x.a.World.create({gravity:{scale:1,x:0,y:0}}),n.matterEngine=x.a.Engine.create({enableSleeping:!0,world:n.matterWorld}),n.matterMouse=x.a.Mouse.create(e),n.matterMouseConstraint=x.a.MouseConstraint.create(n.matterEngine,{mouse:n.matterMouse,constraint:{stiffness:.2,render:{lineWidth:0,strokeStyle:"black",visible:!1}}}),n.matterRender=Ue.create({bounds:{min:{x:-e.width/2,y:-e.height/2},max:{x:e.width/2,y:e.height/2}},canvas:e,engine:n.matterEngine,mouse:n.matterMouse,options:{width:e.width,height:e.height,background:"rgb(0, 0, 0, 0)",wireframes:!1}}),x.a.World.add(n.matterWorld,n.matterMouseConstraint);for(var o=0;o<9;++o)for(var a=0;a<9;++a){var r=x.a.Bodies.circle(50*o-200,50*a-200,20,{restitution:.5});x.a.World.add(n.matterWorld,r)}var i=x.a.Bodies.circle(0,300,50,{restitution:.5});x.a.World.add(n.matterWorld,i),n.matterRunner=x.a.Runner.create({isFixed:!1}),x.a.Events.on(n.matterMouseConstraint,"startdrag",n.onBodyDragStart),x.a.Events.on(n.matterMouseConstraint,"enddrag",n.onBodyDragEnd),x.a.Events.on(n.matterEngine,"beforeUpdate",n.onBeforeUpdate),n.props.onEngineBeforeUpdate&&x.a.Events.on(n.matterEngine,"beforeUpdate",n.props.onEngineBeforeUpdate),n.props.onEngineAfterUpdate&&x.a.Events.on(n.matterEngine,"afterUpdate",n.props.onEngineAfterUpdate),x.a.Events.on(n.matterRender,"beforeRender",n.onBeforeRender),x.a.Events.on(n.matterRender,"beforeObjects",n.onBeforeObjects),x.a.Runner.run(n.matterRunner,n.matterEngine),Ue.run(n.matterRender),window.addEventListener("resize",(function(){n.updateCanvasDimensions()}))}else console.log("Couldn't get a 2D canvas context")}else console.log("Canvas ref is null")},n.onBeforeUpdate=function(e){n.matterMouseConstraint&&(n.props.mouseMode!==Ne.OBJECT?n.matterMouseConstraint.collisionFilter.mask=0:n.matterMouseConstraint.collisionFilter.mask=4294967295)},n.onBeforeRender=function(e){n.matterRender&&(n.matterRender.options.gridSize=n.props.gridSize,n.matterRender.options.showCrosshair=n.state.showCrosshair,n.matterRender.options.crosshairSnap=n.props.snapToGrid)},n.onBeforeObjects=function(e){var t=e.source.context,o=n.getMousePos(!0),a=n.getMousePos(!0,!0);switch(t.setLineDash([]),t.lineWidth=1,n.props.boundaries.forEach((function(e){var o=n.worldToCanvas(e.bounds.min),r=n.worldToCanvas(e.bounds.max),i=x.a.Vector.sub(r,o),s=S(a,{min:o,max:r},!1),l=n.state.clickedBoundary&&n.state.clickedBoundary===e;t.fillStyle=e.color,t.strokeStyle="black",n.props.mouseMode===Ne.BOUNDARY_EDIT&&n.state.resizeMode===je.NONE&&(l||s)?t.globalAlpha=.6:t.globalAlpha=.4,t.beginPath(),t.fillRect(o.x,o.y,i.x,i.y),t.globalAlpha=1,t.rect(o.x,o.y,i.x,i.y),t.stroke()})),n.props.mouseMode){case Ne.BOUNDARY_EDIT:if(!n.state.mouseDownPos||n.state.clickedBoundary||n.state.resizeBoundaries)break;var r=n.worldToCanvas(n.state.mouseDownPos),i=o.x-r.x,s=o.y-r.y;t.strokeStyle="blue",t.fillStyle="rgb(128, 128, 255, 0.2)",t.beginPath(),t.fillRect(r.x,r.y,i,s),t.rect(r.x,r.y,i,s),t.stroke();break;case Ne.SNOOKER:if(!n.state.snookerBody)break;var l=n.worldToCanvas(n.state.snookerBody.position);t.strokeStyle="red",t.beginPath(),t.moveTo(l.x,l.y),t.lineTo(o.x,o.y),t.stroke()}},n.onBodyDragStart=function(){n.setState({draggingBody:!0})},n.onBodyDragEnd=function(){n.setState({draggingBody:!1})},n.checkResizeMode=function(e,t){var o=je.NONE;if(t&&t.length>1){if(4===t.length)o=je.CROSS_SPLIT;else if(2===t.length){var a=t[0].bounds,r=t[1].bounds;o=a.max.y<=r.min.y||r.max.y<=a.min.y?je.HORIZONTAL_SPLIT:je.VERTICAL_SPLIT}}else if(e){var i=n.getMousePos(!0,!0),s={min:n.worldToCanvas(e.bounds.min),max:n.worldToCanvas(e.bounds.max)},l=Math.abs(s.min.x-i.x),c=Math.abs(s.max.x-i.x),d=Math.abs(s.min.y-i.y),u=Math.abs(s.max.y-i.y);l<=10&&d<=10?o=je.TOP_LEFT_CORNER:c<=10&&d<=10?o=je.TOP_RIGHT_CORNER:c<=10&&u<=10?o=je.BOTTOM_RIGHT_CORNER:l<=10&&u<=10?o=je.BOTTOM_LEFT_CORNER:l<=10?o=je.LEFT_EDGE:c<=10?o=je.RIGHT_EDGE:d<=10?o=je.TOP_EDGE:u<=10&&(o=je.BOTTOM_EDGE)}return o},n.onMouseDown=function(e){var t=n.getMousePos(),o=n.getMousePos(!0);switch(n.setState({mouseButton:e.button,mouseDownPos:t,mouseDownPosCanvas:o}),n.props.mouseMode){case Ne.SNOOKER:0===e.button&&n.setState({snookerBody:n.bodyAtPosition(t)});break;case Ne.BOUNDARY_EDIT:var a=n.boundaryUnderMouse(),r=n.boundariesNearMouse();if(!a&&!r.length)break;var i=je.NONE;0===e.button&&(i=n.checkResizeMode(a,r)),r.length>1?n.setState({resizeBoundaries:r,resizeMode:i}):a&&n.setState({clickedBoundary:a,clickedOldBounds:{min:Object.assign({},a.bounds.min),max:Object.assign({},a.bounds.max)},resizeMode:i})}},n.onMouseUp=function(e){if(n.matterWorld){var t=n.getMousePos(),o=n.getMousePos(!0),a=n.state.mouseButton===e.button&&n.state.mouseDownPosCanvas&&n.state.mouseDownPosCanvas.x===o.x&&n.state.mouseDownPosCanvas.y===o.y;switch(n.props.mouseMode){case Ne.OBJECT:if(n.state.draggingBody)break;if(0===e.button){var r=x.a.Bodies.circle(t.x,t.y,20,{restitution:.5});x.a.World.add(n.matterWorld,r),n.props.onObjectAdded&&n.props.onObjectAdded(r)}else if(2===e.button){var i=n.bodyAtPosition(t);i&&(n.props.onObjectDeleted&&n.props.onObjectDeleted(i.id),x.a.Composite.remove(n.matterWorld,i))}break;case Ne.SNOOKER:if(!n.state.snookerBody||0!==e.button)break;var s=n.state.snookerBody,l=x.a.Vector.mult(x.a.Vector.sub(s.position,t),.001*s.mass);x.a.Body.applyForce(s,s.position,l),n.setState({snookerBody:void 0});break;case Ne.BOUNDARY_EDIT:if(n.state.resizeMode!==je.NONE){n.setState({resizeMode:je.NONE,resizeBoundaries:void 0});break}if(n.props.onBoundaryDeleted&&2===e.button&&a&&n.state.clickedBoundary){n.props.onBoundaryDeleted(n.state.clickedBoundary);break}n.props.onBoundaryAdded&&0===e.button&&n.state.mouseDownPos&&n.props.onBoundaryAdded(w(n.state.mouseDownPos,t))}n.setState({mouseButton:void 0,mouseDownPos:void 0,mouseDownPosCanvas:void 0,clickedBoundary:void 0,clickedOldBounds:void 0})}},n.resizingMultiple=function(e){return void 0!==e.length},n.onMouseMove=function(e){if(n.matterRender&&n.matterMouseConstraint){var t=n.getMousePos();if(2===n.state.mouseButton){if(!n.state.mouseDownPos||n.state.draggingBody)return;var o=n.matterRender.bounds,a={x:t.x-n.state.mouseDownPos.x,y:t.y-n.state.mouseDownPos.y};return o.min=x.a.Vector.sub(o.min,a),o.max=x.a.Vector.sub(o.max,a),void x.a.Mouse.setOffset(n.matterMouseConstraint.mouse,o.min)}switch(n.props.mouseMode){case Ne.BOUNDARY_EDIT:if(!n.props.onBoundariesUpdated)break;if(n.state.resizeBoundaries)switch(n.state.resizeMode){case je.CROSS_SPLIT:var r=function(e,t){return e.map((function(e){var n=e.bounds,o={min:Object.assign({},n.min),max:Object.assign({},n.max)};switch([C(t,n.min),C(t,{x:n.max.x,y:n.min.y}),C(t,n.max),C(t,{x:n.min.x,y:n.max.y})].reduce((function(e,t,n,o){return t<o[e]?n:e}),0)){case 0:o.min.x=t.x,o.min.y=t.y;break;case 1:o.max.x=t.x,o.min.y=t.y;break;case 2:o.max.x=t.x,o.max.y=t.y;break;case 3:o.min.x=t.x,o.max.y=t.y}return{boundary:e,newBounds:w(o.min,o.max)}}))}(n.state.resizeBoundaries,t);n.props.onBoundariesUpdated(r);break;case je.HORIZONTAL_SPLIT:case je.VERTICAL_SPLIT:var i=function(e,t,n){var o,a,r=[e[0],e[1]],i=r[0],s=r[1];if(n){if(i.bounds.max.x>s.bounds.min.x){var l=[s,i];i=l[0],s=l[1]}o=w(i.bounds.min,{x:t.x,y:i.bounds.max.y}),a=w({x:t.x,y:s.bounds.min.y},s.bounds.max)}else{if(i.bounds.max.y>s.bounds.min.y){var c=[s,i];i=c[0],s=c[1]}o=w(i.bounds.min,{x:i.bounds.max.x,y:t.y}),a=w({x:s.bounds.min.x,y:t.y},s.bounds.max)}return[{boundary:i,newBounds:o},{boundary:s,newBounds:a}]}(n.state.resizeBoundaries,t,n.state.resizeMode===je.VERTICAL_SPLIT);n.props.onBoundariesUpdated(i)}else if(n.state.clickedBoundary&&n.state.clickedOldBounds){var s={min:Object.assign({},n.state.clickedOldBounds.min),max:Object.assign({},n.state.clickedOldBounds.max)};switch(n.state.resizeMode){case je.TOP_LEFT_CORNER:s.min.x=t.x,s.min.y=t.y;break;case je.TOP_RIGHT_CORNER:s.max.x=t.x,s.min.y=t.y;break;case je.BOTTOM_LEFT_CORNER:s.min.x=t.x,s.max.y=t.y;break;case je.BOTTOM_RIGHT_CORNER:s.max.x=t.x,s.max.y=t.y;break;case je.LEFT_EDGE:s.min.x=t.x;break;case je.RIGHT_EDGE:s.max.x=t.x;break;case je.TOP_EDGE:s.min.y=t.y;break;case je.BOTTOM_EDGE:s.max.y=t.y;break;default:if(!n.state.mouseDownPos)break;var l=x.a.Vector.sub(t,n.state.mouseDownPos);s.min=x.a.Vector.add(s.min,l),s.max=x.a.Vector.add(s.max,l)}s=w(s.min,s.max),n.props.onBoundariesUpdated([{boundary:n.state.clickedBoundary,newBounds:s}]);break}}}},n.onMouseOver=function(e){n.setState({showCrosshair:!0})},n.onMouseOut=function(e){n.setState({showCrosshair:!1,mouseDownPos:void 0,clickedBoundary:void 0})},n.onWheel=function(e){if(n.matterMouse&&n.matterRender){var t=n.matterMouse,o=e.deltaY<0?.9:1/.9,a=n.matterRender.bounds;a.min=x.a.Vector.add(x.a.Vector.mult(x.a.Vector.sub(a.min,t.position),o),t.position),a.max=x.a.Vector.add(x.a.Vector.mult(x.a.Vector.sub(a.max,t.position),o),t.position)}},n.updateCanvasDimensions=function(){var e=n.state.canvasRef.current;e&&(e.width=e.clientWidth,e.height=e.clientHeight,n.matterRender&&(n.matterRender.bounds={min:{x:-e.width/2,y:-e.height/2},max:{x:e.width/2,y:e.height/2}},n.matterRender.options.width=e.width,n.matterRender.options.height=e.height))},n.spawnRandomObjects=function(e){if(n.matterRender&&n.matterWorld){for(var t=[],o=0;o<e;++o){var a=Object(f.random)(n.matterRender.bounds.min.x,n.matterRender.bounds.max.x,!0),r=Object(f.random)(n.matterRender.bounds.min.y,n.matterRender.bounds.max.y,!0);t.push(x.a.Bodies.circle(a,r,10,{restitution:.5}))}x.a.World.add(n.matterWorld,t)}},n.clearAllObjects=function(){n.matterMouseConstraint&&n.matterWorld&&(x.a.World.clear(n.matterWorld,!1),x.a.World.add(n.matterWorld,n.matterMouseConstraint))},n.showAllObjects=function(){n.matterWorld&&n.matterWorld.bodies.length>0&&Ue.lookAt(n.matterRender,n.matterWorld.bodies,{x:50,y:50},!0)},n.resetView=function(){if(n.state.canvasRef.current&&n.matterRender){var e=n.state.canvasRef.current,t=n.matterRender,o={x:e.width/2,y:e.height/2};t.bounds.min=x.a.Vector.neg(o),t.bounds.max=o}},n.worldToCanvas=function(e){if(!n.matterRender)return{x:0,y:0};var t=n.matterRender,o=t.canvas.width/(t.bounds.max.x-t.bounds.min.x);return x.a.Vector.mult(x.a.Vector.sub(e,t.bounds.min),o)},n.boundaryUnderMouse=function(){if(n.matterMouse){var e=n.matterMouse;return n.props.boundaries.find((function(t){return S(e.position,t.bounds)}))}},n.boundariesNearMouse=function(){if(!n.matterMouse)return[];var e=n.matterMouse;return n.props.boundaries.filter((function(t){return function(e,t,n){var o=(n.max.x-n.min.x)/2,a=(n.max.y-n.min.y)/2,r=n.min.x+o,i=n.min.y+a,s=Math.abs(e.x-r),l=Math.abs(e.y-i);return!(s>o+t)&&(!(l>a+t)&&(s<=o||(l<=a||Math.pow(s-o,2)+Math.pow(l-a,2)<=Math.pow(t,2))))}(e.position,5,t.bounds)}))},n.bodyAtPosition=function(e){if(n.matterWorld){var t=x.a.Composite.allBodies(n.matterWorld);return x.a.Query.point(t,e)[0]}},n.getMousePos=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!n.matterMouse)return{x:0,y:0};var o=n.props.gridSize,a=Object.assign({},n.matterMouse.position);return!t&&n.props.snapToGrid&&(a.x=Math.round(a.x/o)*o,a.y=Math.round(a.y/o)*o),e?n.worldToCanvas(a):a},n.getCanvasCursorStyle=function(){if(n.props.mouseMode===Ne.BOUNDARY_EDIT){var e=n.boundaryUnderMouse(),t=n.boundariesNearMouse();switch(n.checkResizeMode(e,t)){case je.TOP_LEFT_CORNER:return"nw-resize";case je.TOP_RIGHT_CORNER:return"ne-resize";case je.BOTTOM_RIGHT_CORNER:return"se-resize";case je.BOTTOM_LEFT_CORNER:return"sw-resize";case je.LEFT_EDGE:return"w-resize";case je.RIGHT_EDGE:return"e-resize";case je.TOP_EDGE:return"n-resize";case je.BOTTOM_EDGE:return"s-resize";case je.CROSS_SPLIT:return"move";case je.HORIZONTAL_SPLIT:return"ns-resize";case je.VERTICAL_SPLIT:return"ew-resize"}if(e&&n.state.clickedBoundary)return"grabbing";if(e)return"grab"}return"crosshair"};var a=o.createRef();return n.state={canvasRef:a,showCrosshair:!1,draggingBody:!1,mouseButton:void 0,mouseDownPos:void 0,mouseDownPosCanvas:void 0,dragStartPos:void 0,dragLastPos:void 0,snookerBody:void 0,clickedBoundary:void 0,clickedOldBounds:void 0,resizeBoundaries:void 0,resizeMode:je.NONE},n}return Object(m.a)(t,e),Object(ne.a)(t,[{key:"render",value:function(){return o.createElement(Ve,{cursor:this.getCanvasCursorStyle(),ref:this.state.canvasRef,onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onMouseMove:this.onMouseMove,onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,onWheel:this.onWheel})}}]),t}(o.PureComponent),Ge=n(188),We=n(78);var Le=function(e){return a.a.createElement(Ge.a,null,a.a.createElement(We.a,{className:"mr-2"},a.a.createElement(j.a,{size:"sm",variant:"secondary",title:"Object mode",active:e.mouseMode===Ne.OBJECT,onClick:function(){e.onMouseModeChanged(Ne.OBJECT)}},a.a.createElement(A.a,{icon:"cube"})),a.a.createElement(j.a,{size:"sm",variant:"secondary",title:"Boundary mode",active:e.mouseMode===Ne.BOUNDARY_EDIT,onClick:function(){e.onMouseModeChanged(Ne.BOUNDARY_EDIT)}},a.a.createElement(A.a,{icon:"vector-square"})),a.a.createElement(j.a,{size:"sm",variant:"secondary",title:"Snooker mode",active:e.mouseMode===Ne.SNOOKER,onClick:function(){e.onMouseModeChanged(Ne.SNOOKER)}},a.a.createElement(A.a,{icon:"bowling-ball"}))),a.a.createElement(We.a,{className:"mr-2"},a.a.createElement(j.a,{size:"sm",variant:"secondary",title:"Reset view",onClick:e.onHomeClicked},a.a.createElement(A.a,{icon:"home"})),a.a.createElement(j.a,{size:"sm",variant:"secondary",title:"Show all objects",onClick:e.onShowAllObjectsClicked},a.a.createElement(A.a,{icon:"eye"}))),a.a.createElement(We.a,{className:"mr-2"},a.a.createElement(j.a,{size:"sm",variant:"secondary",title:"Toggle snap to grid",active:e.snapToGrid,onClick:function(){e.onSnapToGridChanged(!e.snapToGrid)}},a.a.createElement(A.a,{icon:"magnet"})),a.a.createElement(j.a,{size:"sm",variant:"secondary",title:"Decrease grid size",onClick:e.onDecreaseGridSizeClicked},a.a.createElement(A.a,{icon:"th"})),a.a.createElement(j.a,{size:"sm",variant:"secondary",title:"Increase grid size",onClick:e.onIncreaseGridSizeClicked},a.a.createElement(A.a,{icon:"th-large"}))),a.a.createElement(We.a,{className:"mr-2"},a.a.createElement(j.a,{size:"sm",variant:"secondary",title:"Spawn random objects",onClick:e.onRandomClicked},a.a.createElement(A.a,{icon:"dice"})),a.a.createElement(j.a,{size:"sm",variant:"warning",title:"Remove all objects",onClick:e.onClearClicked},a.a.createElement(A.a,{icon:"radiation"}))))},He=["#e6194b","#3cb44b","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080","#ffe119","#ffffff","#000000"],qe=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(d.a)(this,Object(u.a)(t).call(this,e))).physicsSimRef=void 0,n.lastFrameTime=void 0,n.frameTimeHistory=void 0,n.componentDidMount=function(){n.state.utilFunctions.forEach((function(e,t){return n.onUtilFunctionUpdated(t,e.expression)})),n.onServerUtilFunctionUpdated(n.state.utilServer.expression)},n.onEngineBeforeUpdate=function(e){n.lastFrameTime=window.performance.now()},n.onEngineAfterUpdate=function(e){var t=window.performance.now(),o=t-n.lastFrameTime;n.frameTimeHistory.push(o),n.frameTimeHistory.shift();var a=n.frameTimeHistory.reduce((function(e,t){return e+t}))/n.frameTimeHistory.length,r=n.state.boundaries.slice(),i=x.a.Composite.allBodies(e.source.world),s=i.length;r.forEach((function(e){for(var t=0,n=0,o=0,r=0;r<i.length;){var l=i[r];S(l.position,e.bounds,!0)?(++t,l.isSleeping||++o,O(l.position,l.circleRadius,e.bounds)&&++n,l.render.fillStyle=e.color,i.splice(r,1)):++r}e.vars.lambda=(t?Math.min(1,o/s):0)+.1*Math.random(),e.vars.delta=a,e.vars.alpha=t?o/t:0,e.vars.beta=t?n/t:0,e.vars.n=t})),i.forEach((function(e){return e.render.fillStyle="black"}));var l=(t-n.state.lastBoundaryMoveTime)/1e3,c={sigma:r.length,t:l,N:s};n.setState({boundaries:r,utilGlobalVars:c})},n.validateResize=function(e){var t=[];return n.state.boundaries.forEach((function(n){e.some((function(e){return e.boundary===n}))||t.push(n.bounds)})),e.every((function(n){var o=n.newBounds;if(o.min.x===o.max.x||o.min.y===o.max.y)return!1;var a=[].concat(t);return e.forEach((function(e){return e!==n&&a.push(e.newBounds)})),!a.some((function(e){return k(o,e)}))}))},n.validateBoundary=function(e,t){return e.min.x!==e.max.x&&e.min.y!==e.max.y&&n.state.boundaries.every((function(n){return n===t||!k(e,n.bounds)}))},n.onBoundaryAdded=function(e){if(n.validateBoundary(e)){var t=n.state.boundaries.slice();t.push({bounds:e,color:He[t.length%He.length],vars:{}}),n.setState({boundaries:t,lastBoundaryMoveTime:window.performance.now()})}},n.onBoundaryDeleted=function(e){var t=n.state.boundaries.findIndex((function(t){return t===e}));if(-1!==t){var o=n.state.boundaries.slice();o.splice(t,1),n.setState({boundaries:o,lastBoundaryMoveTime:window.performance.now()})}},n.onBoundariesUpdated=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!t||n.validateResize(e)){var o=n.state.boundaries.slice();e.forEach((function(e){for(var t=0;t<o.length;++t)if(e.boundary===o[t]){var n=o[t].bounds;n.min.x=e.newBounds.min.x,n.min.y=e.newBounds.min.y,n.max.x=e.newBounds.max.x,n.max.y=e.newBounds.max.y;break}})),n.setState({boundaries:o,lastBoundaryMoveTime:window.performance.now()})}},n.onUtilFunctionUpdated=function(e,t){var o=n.state.utilFunctions.slice();o[e].expression=t;try{o[e].evalFunc=p()(t,{e:Math.E,pi:Math.PI})}catch(a){o[e].evalFunc=null}n.setState({utilFunctions:o})},n.onServerUtilFunctionUpdated=function(e){var t=Object(f.cloneDeep)(n.state.utilServer);t.expression=e;try{t.evalFunc=p()(e,{e:Math.E,pi:Math.PI})}catch(o){t.evalFunc=void 0}n.setState({utilServer:t})},n.onUtilConstantUpdated=function(e,t){var o=Object(f.cloneDeep)(n.state.utilConstants);o[e]=t,n.setState({utilConstants:o})},n.onUtilVarUpdated=function(e,t){var o=n.state.utilFunctions.slice();o[e].utilVar=t,n.setState({utilFunctions:o})},n.onUtilFunctionAdded=function(){var e=n.state.utilFunctions.slice();e.push({expression:"",utilVar:"x",color:He[e.length%He.length]}),n.setState({utilFunctions:e})},n.onUtilFunctionDeleted=function(e){var t=n.state.utilFunctions.slice();t.splice(e,1),n.setState({utilFunctions:t})},n.onChangeColorClicked=function(e){n.setState({showColorPicker:!n.state.showColorPicker,colorIndex:n.state.showColorPicker?void 0:e})},n.onColorUpdated=function(e){var t=n.state.utilFunctions.slice();t[n.state.colorIndex].color=e.hex,n.setState({utilFunctions:t})},n.onRandomClicked=function(){n.physicsSimRef.current&&n.physicsSimRef.current.spawnRandomObjects(100)},n.onClearClicked=function(){n.physicsSimRef.current&&n.physicsSimRef.current.clearAllObjects()},n.onHomeClicked=function(){n.physicsSimRef.current&&n.physicsSimRef.current.resetView()},n.onShowAllObjectsClicked=function(){n.physicsSimRef.current&&n.physicsSimRef.current.showAllObjects()},n.onImportClicked=function(){n.setState({showImportModal:!0})},n.onImportModalClosed=function(){n.setState({showImportModal:!1})},n.onExportClicked=function(){var e={simState:{boundaries:n.state.boundaries,utilFunctions:n.state.utilFunctions,utilConstants:n.state.utilConstants,utilGlobalVars:n.state.utilGlobalVars,utilServer:n.state.utilServer}};if(n.physicsSimRef.current&&n.physicsSimRef.current.matterWorld){var t=n.physicsSimRef.current.matterWorld,o=x.a.Composite.allBodies(t).map((function(e){var t={inverseMass:e.inverseMass,mass:e.mass,position:e.position,speed:e.speed,velocity:e.velocity};return e.circleRadius?t.circleRadius=e.circleRadius:t.vertices=e.vertices.map((function(e){return x.a.Vector.create(e.x,e.y)})),t}));e.bodies=o}Object(v.saveAs)(new Blob([JSON.stringify(e)]),function(){var e=new Date;return"auratool_export_".concat(function(e){var t=function(e){return e<10?"0"+e:e};return e.getFullYear()+"-"+t(e.getMonth()+1)+"-"+t(e.getDate())+"_"+t(e.getHours())+"-"+t(e.getMinutes())+"-"+t(e.getSeconds())}(e),".json")}())},n.onFilesSelected=function(e){var t=e[0],o=new FileReader;o.readAsBinaryString(t),o.onloadend=function(){var e=JSON.parse(o.result);if(e.simState&&n.setState(e.simState),e.bodies&&n.physicsSimRef.current&&n.physicsSimRef.current.matterWorld){var t=n.physicsSimRef.current.matterWorld;e.bodies.forEach((function(e){var n;n=e.circleRadius?x.a.Bodies.circle(e.position.x,e.position.y,e.circleRadius,e):x.a.Body.create(e),x.a.Body.setVelocity(n,n.velocity),x.a.World.add(t,n)}))}}},n.render=function(){return o.createElement(Z,null,o.createElement(Ee,{show:n.state.showImportModal,onFilesSelected:n.onFilesSelected,onHide:n.onImportModalClosed,onClosed:n.onImportModalClosed}),o.createElement(ue,{onImportClickedCallback:n.onImportClicked,onExportClickedCallback:n.onExportClicked}),o.createElement(X,null,o.createElement(K,null,o.createElement($,null,o.createElement(Le,{mouseMode:n.state.mouseMode,snapToGrid:n.state.snapToGrid,onMouseModeChanged:function(e){n.setState({mouseMode:e})},onHomeClicked:n.onHomeClicked,onShowAllObjectsClicked:n.onShowAllObjectsClicked,onRandomClicked:n.onRandomClicked,onClearClicked:n.onClearClicked,onSnapToGridChanged:function(e){n.setState({snapToGrid:e})},onIncreaseGridSizeClicked:function(){n.setState({gridSize:2*n.state.gridSize})},onDecreaseGridSizeClicked:function(){n.setState({gridSize:Math.max(25,n.state.gridSize/2)})}})),o.createElement(ze,{ref:n.physicsSimRef,boundaries:n.state.boundaries,gridSize:n.state.gridSize,mouseMode:n.state.mouseMode,snapToGrid:n.state.snapToGrid,onBoundaryAdded:n.onBoundaryAdded,onBoundariesUpdated:n.onBoundariesUpdated,onBoundaryDeleted:n.onBoundaryDeleted,onEngineBeforeUpdate:n.onEngineBeforeUpdate,onEngineAfterUpdate:n.onEngineAfterUpdate})),o.createElement(K,null,o.createElement(re,{boundaries:n.state.boundaries,utilFunctions:n.state.utilFunctions,utilConstants:n.state.utilConstants,utilGlobalVars:n.state.utilGlobalVars})),o.createElement(te,{boundaries:n.state.boundaries,utilFunctions:n.state.utilFunctions,utilConstants:n.state.utilConstants,utilGlobalVars:n.state.utilGlobalVars,utilServer:n.state.utilServer,onUtilFunctionUpdated:n.onUtilFunctionUpdated,onUtilFunctionAdded:n.onUtilFunctionAdded,onUtilFunctionDeleted:n.onUtilFunctionDeleted,onServerUtilFunctionUpdated:n.onServerUtilFunctionUpdated,onUtilConstantUpdated:n.onUtilConstantUpdated,onUtilVarUpdated:n.onUtilVarUpdated,onChangeColorClicked:n.onChangeColorClicked,onColorUpdated:n.onColorUpdated,showColorPicker:n.state.showColorPicker,colorIndex:n.state.colorIndex})))};var a={};Object.keys(P).forEach((function(e){return a[e]=P[e].defaultValue})),n.physicsSimRef=o.createRef(),n.lastFrameTime=0,n.frameTimeHistory=new Array(10);var r=Object(b.get)("utilSim");return r?(console.log("Loading settings from local storage"),n.state=r,Object(d.a)(n)):(console.log("Using default settings"),n.state={showColorPicker:!1,showImportModal:!1,colorIndex:0,lastBoundaryMoveTime:window.performance.now(),mouseMode:Ne.OBJECT,gridSize:50,snapToGrid:!1,boundaries:[{bounds:{min:{x:0,y:-1e5},max:{x:1e5,y:0}},color:He[0],vars:{}},{bounds:{min:{x:0,y:0},max:{x:1e5,y:1e5}},color:He[1],vars:{}},{bounds:{min:{x:-1e5,y:-0},max:{x:0,y:1e5}},color:He[2],vars:{}},{bounds:{min:{x:-1e5,y:-1e5},max:{x:0,y:0}},color:He[3],vars:{}}],utilFunctions:[{expression:"e^(-10alpha)",utilVar:"alpha",color:He[5]},{expression:"e^(-5beta)",utilVar:"beta",color:He[6]},{expression:"min(max(0, -log(delta, 1000/60)), 1)",utilVar:"delta",color:He[7]}],utilConstants:a,utilGlobalVars:{},utilServer:{expression:"U_alpha + U_beta + U_delta"}},n)}return Object(m.a)(t,e),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(71).b.add(de.a,de.b,de.c,de.d,de.e,de.f,de.g,de.h,de.i,de.j,de.k,de.l,de.m,de.n,de.o,de.p,de.q,de.r);i.a.render(a.a.createElement(l.a.Context,{input:"ascii",options:{asciimath2jax:{useMathMLspacing:!0,preview:"none"}}},a.a.createElement(qe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[195,1,2]]]);
//# sourceMappingURL=main.7f91c3e2.chunk.js.map